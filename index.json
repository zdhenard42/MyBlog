[{"content":"","date":null,"permalink":"/tags/analysis/","section":"Tags","summary":"","title":"Analysis"},{"content":"The final product of this blog can be found here!\nCybersecurity is and will always be a game of cat and mouse.\nOne of the latest tactics used by threat actors is an attack vector called \u0026ldquo;Quishing\u0026rdquo;. \u0026ldquo;Quishing\u0026rdquo; is the act of creating QR codes that contain malicious data such as fake login pages. This attack vector is particularly effective due to its simplicity.\nHoxhunt reports that 22% of phishing attacks used QR codes in October1.\nI realized we\u0026rsquo;re kinda in the wild west with this new threat. Not many shields or swords to fight this dragon. So, I rolled up my sleeves and thought, \u0026ldquo;Why not build something myself?\u0026rdquo;\nQR Codes: The Double-Edged Sword of Digital Convenience and Security Risks #QR codes, or \u0026ldquo;Quick Response Codes\u0026rdquo;, are now a staple in our digital life. They encode data into a 2-D image that smartphones can easily read, storing information like URLs and Wi-Fi credentials.\nWe saw a massive surge in the use of QR codes in 2020 due to\u0026hellip; You guessed it, COVID! The contactless aspect of QR codes allowed many companies to replace items commonly touched with QR codes, such as Food Menus.\nHowever, this convenience also presents security risks.\nConsider this scenario: You are at a hotel with poor cell service, but you urgently need to send documents. A QR code in the elevator allows you to connect to the hotel Wi-Fi, but instead actually connects you to an Evil Twin network set up by an attacker. Now, your sensitive data is exposed without your knowledge.\nDecoding the Mystery: QR Code to URL Conversion #I knew the first step in creating this platform would be decoding the QR code.\nI came across an API created by goqr.me that would allow me to do exactly that. After some testing, I was successfully able to send a QR code and receive back the URL.\nAfter testing with samples of legitimate Quishing files, I realized that attackers had a trick up their sleeve to bypass initial reputation scans of the URL\u0026hellip;\nUnraveling the Web: Tracking URL Redirects #Attackers were using legitimate redirect services to hide the destination URL contained in the payload.\nMany times the redirect service would return a clean report when scanned even though the destination address was malicious. Some Quishing samples redirected up to 6 times before reaching the destination address!\nI found an API developed by Redirect-Checker.net that would follow the redirects and return the destination address as well as the destination IP!\nThis proved to be very useful when performing analysis in later steps.\nPeering into the Digital Abyss: Shodan Insights #One analysis tool that I have come to love is Shodan. Shodan is a search engine that will gather information about most internet-connected devices and systems.\nUsing Shodan\u0026rsquo;s API along with the destination IP I received earlier, I was able to gather the following:\nAutonomous System Number (ASN) Open ports on the destination IP address Country that the IP was located in Operating System running on the destination IP Guardians of the Net: AbuseIPDB Analysis #Another common reputation database that I like to check against is AbuseIPDB. AbuseIPDB also conveniently offers an API.\nLeveraging AbuseIPDB API, I am able to gather the following:\nAbuse Confidence Score ISP that owns the IP address Usage type of the IP address Number of times that IP has been reported If the IP has ever been used as a Tor relay A Shield Against Digital Threats: VirusTotal\u0026rsquo;s Role #Arguably one of the most common online analysis tools is VirusTotal. VirusTotal is an online service that analyzes suspicious files and URLs.\nBy this point you can probably guess\u0026hellip; they have an API!\nI utilized this API to gather:\nThe CIDR block the IP address belonged to An analysis of the IP address A WhoIs containing the domain registrar information The URL Sentinel: URLHaus API Integration #The last tool that I leveraged when analyzing these QR codes was URLHaus.\nPrior to this project I was not very familiar with URLHaus. After seeing how large of a database URLHaus offered, I knew this would be very useful for analysis. URLHaus API provides data that is not available from other services I am using.\nHere is what I am gathering from URLHaus:\nThe status of the URL (Offline or Online) The payload that the address is delivering A link to the URLHaus analysis of the queried URL Tags associated with the queried URL User Experience: Aggregating the data #After all the queries have been made, I needed a way to cleanly present this back to the user.\nI never have been proficient in front-end design so my design process went something like this:\nStep 1: Format how the API response is displayed to the user\nStep 2: Ask peers and friends what they thought of the design\nStep 3: GOTO Step 1\nAfter many iterations of redesigning the front-end experience, I finally settled on a design.\nHere is the output of Quishing sample scan:\nConclusion #Gaining the ability to create my own API has introduced a completely new method to approaching projects in the future. The customization that comes with having complete control over the data returned is invaluable.\nNow, users can scan QR codes on my platform with confidence, knowing they\u0026rsquo;ll be alerted to any potential security risks.\nThis project was a significant step in my journey as a developer and a valuable contribution to cybersecurity awareness. It\u0026rsquo;s a testament to how innovative solutions can emerge from challenges, especially in the ever-evolving landscape of digital security.\nRecreate this yourself! #The source code of my API is available on Github. I would recommend utilizing Cloudflare Workers when first creating an API due to the generous usage limits that come with the free plan.\nFeel free to create a pull request with any improvements you see fit!\nHoxHunt Stats\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","date":"16 November 2023","permalink":"/p/building-a-qr-code-security-analysis-tool/","section":"Posts","summary":"Exploring the creation of an API to counter \u0026ldquo;Quishing,\u0026rdquo; this post highlights the use of advanced tools for analyzing and mitigating threats from malicious QR codes.","title":"Building a QR Code Security Analysis Tool"},{"content":"","date":null,"permalink":"/tags/cybersecurity/","section":"Tags","summary":"","title":"Cybersecurity"},{"content":"","date":null,"permalink":"/tags/javascript/","section":"Tags","summary":"","title":"JavaScript"},{"content":"","date":null,"permalink":"/tags/open-source/","section":"Tags","summary":"","title":"Open Source"},{"content":"","date":null,"permalink":"/posts/","section":"Posts","summary":"","title":"Posts"},{"content":"","date":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags"},{"content":"","date":null,"permalink":"/","section":"Zachary Henard","summary":"","title":"Zachary Henard"},{"content":"","date":"1 January 0001","permalink":"/cv/","section":"Zachary Henard","summary":"","title":""},{"content":"","date":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories"}]