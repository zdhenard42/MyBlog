<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="rgb(255,255,255)"><title>Tunneling Internal Services through Cloudflare &#183; Zachary Henard</title>
<meta name=title content="Tunneling Internal Services through Cloudflare &#183; Zachary Henard"><script type=text/javascript src=/js/appearance.min.022d0ebc3b46a335eb1c7ef79b7f2de143d7cd5156d433638592ef1ce5f8554e.js integrity="sha256-Ai0OvDtGozXrHH73m38t4UPXzVFW1DNjhZLvHOX4VU4="></script><link type=text/css rel=stylesheet href=/css/main.bundle.min.91cd2b4f19a0a10dc601de3cca4df4c98fc7868b40039ad8d9902495c5297052.css integrity="sha256-kc0rTxmgoQ3GAd48yk30yY/HhotAA5rY2ZAklcUpcFI="><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.81b6b27b20d7cc222185cf48bd73cd7dac1fa12efea633d2e2c7b1930d36259f.js integrity="sha256-gbayeyDXzCIhhc9IvXPNfawfoS7+pjPS4sexkw02JZ8=" data-copy=Copy data-copied=Copied></script><meta name=description content="
      
        A guide on setting up and managing Cloudflare tunnels to securely expose internal services using practical examples and security measures.
      
    "><link rel=canonical href=https://henard.xyz/p/tunneling-internal-services/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://henard.xyz/p/tunneling-internal-services/"><meta property="og:site_name" content="Zachary Henard"><meta property="og:title" content="Tunneling Internal Services through Cloudflare"><meta property="og:description" content="A guide on setting up and managing Cloudflare tunnels to securely expose internal services using practical examples and security measures."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-01-18T00:00:00+00:00"><meta property="article:modified_time" content="2025-03-21T19:21:53-04:00"><meta property="article:tag" content="Cybersecurity"><meta property="article:tag" content="Cloudflare"><meta property="article:tag" content="Homelab"><meta property="og:image" content="https://henard.xyz/p/tunneling-internal-services/feature.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://henard.xyz/p/tunneling-internal-services/feature.png"><meta name=twitter:title content="Tunneling Internal Services through Cloudflare"><meta name=twitter:description content="A guide on setting up and managing Cloudflare tunnels to securely expose internal services using practical examples and security measures."><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Tunneling Internal Services through Cloudflare","headline":"Tunneling Internal Services through Cloudflare","abstract":"A guide on setting up and managing Cloudflare tunnels to securely expose internal services using practical examples and security measures.","inLanguage":"en","url":"https:\/\/henard.xyz\/p\/tunneling-internal-services\/","author":{"@type":"Person","name":""},"copyrightYear":"2024","dateCreated":"2024-01-18T00:00:00\u002b00:00","datePublished":"2024-01-18T00:00:00\u002b00:00","dateModified":"2025-03-21T19:21:53-04:00","keywords":["Cybersecurity","Cloudflare","Homelab"],"mainEntityOfPage":"true","wordCount":"675"}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-XWGQEMWHN9"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XWGQEMWHN9")}</script></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold pe-2 text-primary-600 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="py-6 font-semibold text-neutral-900 dark:text-neutral print:hidden sm:py-10"><nav class="flex items-start justify-between sm:items-center"><div class="z-40 flex flex-row items-center"><a href=/ class=mr-2><img src=/Zachary-Henard-logo-white-on-transparent-background.png width=250 height=250 class="max-h-[10rem] max-w-[10rem] object-scale-down object-left hidden dark:flex" alt="Zachary Henard">
<img src=/Zachary-Henard-logo-black-on-transparent-background.png width=250 height=250 class="max-h-[10rem] max-w-[10rem] object-scale-down object-left dark:hidden" alt="Zachary Henard"></a></div><label id=menu-button for=menu-controller class="block sm:hidden"><input type=checkbox id=menu-controller class=hidden><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative inline-block align-text-bottom px-1 icon"><svg viewBox="0 0 448 512"><path fill="currentcolor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="fixed inset-0 z-30 invisible w-full h-full m-auto overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50"><ul class="flex flex-col w-full px-6 py-6 mx-auto overflow-visible list-none max-w-7xl text-end sm:px-14 sm:py-10 sm:pt-10 md:px-24 lg:px-32"><li class=mb-1><span class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative inline-block align-text-bottom px-1 icon"><svg viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class="mb-1 group"><a href=/posts/ title=Posts><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Posts</span></a></li><li class="mb-1 group"><a href=/tags/ title=Tags><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Tags</span></a></li><li class="mb-1 group"><button id=appearance-switcher-1 type=button aria-label="appearance switcher">
<span class="inline transition-colors group-dark:hover:text-primary-400 group-hover:text-primary-600 dark:hidden" title="Switch to dark appearance"><span class="relative inline-block align-text-bottom px-1 icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg>
</span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span>
</span><span class="hidden transition-colors group-dark:hover:text-primary-400 group-hover:text-primary-600 dark:inline" title="Switch to light appearance"><span class="relative inline-block align-text-bottom px-1 icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg>
</span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span></span></button></li><li class="mb-1 group"><button id=search-button-m0 title="Search (/)">
<span class="transition-colors group-dark:hover:text-primary-400 group-hover:text-primary-600"><span class="relative inline-block align-text-bottom px-1 icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></span></button></li></ul></div></label><ul class="flex-row hidden list-none text-end sm:flex"><li class="mb-1 group sm:mb-0 sm:me-7 sm:last:me-0"><a href=/posts/ title=Posts><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Posts</span></a></li><li class="mb-1 group sm:mb-0 sm:me-7 sm:last:me-0"><a href=/tags/ title=Tags><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Tags</span></a></li><li class="mb-1 group sm:mb-0 sm:me-7 sm:last:me-0"><button id=appearance-switcher-2 type=button aria-label="appearance switcher">
<span class="inline transition-colors group-dark:hover:text-primary-400 group-hover:text-primary-600 dark:hidden" title="Switch to dark appearance"><span class="relative inline-block align-text-bottom px-1 icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg>
</span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span>
</span><span class="hidden transition-colors group-dark:hover:text-primary-400 group-hover:text-primary-600 dark:inline" title="Switch to light appearance"><span class="relative inline-block align-text-bottom px-1 icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg>
</span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span></span></button></li><li class="mb-1 group sm:mb-0 sm:me-7 sm:last:me-0"><button id=search-button-m1 title="Search (/)">
<span class="transition-colors group-dark:hover:text-primary-400 group-hover:text-primary-600"><span class="relative inline-block align-text-bottom px-1 icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></span></button></li></ul></nav></header><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header class=max-w-prose><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class="inline hidden"><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>Zachary Henard</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/>Posts</a><span class="px-1 text-primary-500">/</span></li><li class="inline hidden"><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/p/tunneling-internal-services/>Tunneling Internal Services through Cloudflare</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Tunneling Internal Services through Cloudflare</h1><div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2024-01-18 00:00:00 +0000 UTC">18 January 2024</time><span class="px-2 text-primary-500">&#183;</span><time datetime="2025-03-21 19:21:53 -0400 -0400">Updated: 21 March 2025</time><span class="px-2 text-primary-500">&#183;</span><span>675 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">4 mins</span></div><div class="flex flex-wrap my-1 text-xs leading-relaxed text-neutral-500 dark:text-neutral-400"><a href=/tags/cybersecurity/ class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">Cybersecurity</a>
<a href=/tags/cloudflare/ class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">Cloudflare</a>
<a href=/tags/homelab/ class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">Homelab</a></div></div><div class=prose><img class="mb-6 -mt-4 rounded-md" width=1792 height=1024 srcset="/p/tunneling-internal-services/feature_hu_84bf78c65d9b77e3.png 330w,/p/tunneling-internal-services/feature_hu_a579bd3457e90aef.png 660w,/p/tunneling-internal-services/feature_hu_d451665f451afad2.png 1024w,/p/tunneling-internal-services/feature_hu_3251c2e57c259c12.png 2x" alt="Servers connecting to a cloud"></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first px-0 lg:order-last lg:max-w-xs lg:ps-8"><div class="toc pe-5 print:hidden lg:sticky lg:top-10"><details open class="-ms-5 mt-0 overflow-hidden rounded-lg ps-5"><summary class="-ms-5 block cursor-pointer bg-neutral-100 py-1 ps-5 text-lg font-semibold text-neutral-800 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="-ms-5 border-s border-dotted border-neutral-300 py-2 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><ul><li><a href=#initial-setup>Initial Setup</a></li><li><a href=#building-your-first-tunnel>Building your first tunnel</a></li><li><a href=#exposing-internal-services>Exposing Internal Services</a></li><li><a href=#accessing-the-service>Accessing The Service</a></li><li><a href=#adding-additional-services>Adding Additional Services</a></li><li><a href=#bonus-adding-authentication-and-access-rules>Bonus: Adding Authentication and Access Rules</a></li></ul></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-prose grow"><p>In this post I dive into the simplicity and security of Cloudflare tunneling, which is offered by Cloudflare at no cost. This post will guide you on how to easily and safely expose internal services without exposing your network.</p><h2 id=initial-setup class="relative group">Initial Setup <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#initial-setup aria-label=Anchor>#</a></span></h2><p>To expose your internal services over a Cloudflare tunnel, you will first need to create a Cloudflare account. You can <a href=https://dash.cloudflare.com/sign-up target=_blank rel=noreferrer>register here</a>.</p><p>You will then need to own a domain and setup <a href=https://developers.cloudflare.com/dns/zone-setups/full-setup/setup/ target=_blank rel=noreferrer>Cloudflare nameservers</a> for DNS on the domain.
If you do not already own a domain, I recommend purchasing through <a href=https://www.cloudflare.com/products/registrar/ target=_blank rel=noreferrer>Cloudflare</a> due to their very affordable &ldquo;At-Cost&rdquo; model.</p><h2 id=building-your-first-tunnel class="relative group">Building your first tunnel <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#building-your-first-tunnel aria-label=Anchor>#</a></span></h2><p>After you have successfully tied your domain to your Cloudflare account, we can start creating tunnels!<br>In your Cloudflare dashboard, navigate to &lsquo;Zero Trust&rsquo; -> &lsquo;Access&rsquo; -> &lsquo;Tunnels&rsquo;<figure><img class="mx-auto my-0 rounded-md" width=259 height=617 src=/p/tunneling-internal-services/CloudflareTunnel.png alt="CloudFlare Access" loading=lazy></figure></p><p>Once you are at the &lsquo;Tunnels&rsquo; screen, simply click &ldquo;Create a tunnel&rdquo;.
The first prompt you will see is the tunnel name.
This can be any label you want to use that helps you to identify the network that is being tunneled.
Keep in mind that 99% of the time all of your exposed services will be routed through the same tunnel.<br>The next step is running the connector for your tunnel.
I highly recommend docker for this due to the ease of management.
As long as the service is reachable from the docker container, then it can be routed through a tunnel.</p><p>Upon selecting docker as your environment, you will be given a command to run in the terminal on your host device.<figure><img class="mx-auto my-0 rounded-md" width=1613 height=644 srcset="/p/tunneling-internal-services/TunnelConnector_hu_b71d8225606b75ce.png 330w,/p/tunneling-internal-services/TunnelConnector_hu_e0fbccf89f4446b8.png 660w,/p/tunneling-internal-services/TunnelConnector_hu_d451fcbad5051979.png 1024w,/p/tunneling-internal-services/TunnelConnector_hu_ac1036f1ede4327c.png 2x" src=/p/tunneling-internal-services/TunnelConnector_hu_e0fbccf89f4446b8.png alt=Connector loading=lazy></figure></p><p>Simply enter this command into your host CLI and your tunnel will be built!<br>I like to add &lsquo;-d&rsquo; to the command so that the connector is started in detached mode and will run in the background.<figure><img class="mx-auto my-0 rounded-md" width=613 height=142 src=/p/tunneling-internal-services/connectorCLI.png alt="Detached Container" loading=lazy></figure></p><h2 id=exposing-internal-services class="relative group">Exposing Internal Services <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#exposing-internal-services aria-label=Anchor>#</a></span></h2><p>The tunnel is built, now we just have to start routing services through it.</p><p>For this demo, I will route an instance of self-hosted CyberChef which is running on &ldquo;10.0.24.7:3000&rdquo; on my homelab.
All we have to do is enter the subdomain we want it to be accessible at, and where is it located on my internal network.<figure><img class="mx-auto my-0 rounded-md" width=708 height=304 srcset="/p/tunneling-internal-services/RoutingCyberChef_hu_68695e2522344fe4.png 330w,/p/tunneling-internal-services/RoutingCyberChef_hu_369b16a23eddc440.png 660w,/p/tunneling-internal-services/RoutingCyberChef_hu_5cad92f44fb8d1d7.png 1024w,/p/tunneling-internal-services/RoutingCyberChef_hu_63daa5ca3eb478cd.png 2x" src=/p/tunneling-internal-services/RoutingCyberChef_hu_369b16a23eddc440.png alt="Exposing CyberChef" loading=lazy></figure></p><h2 id=accessing-the-service class="relative group">Accessing The Service <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#accessing-the-service aria-label=Anchor>#</a></span></h2><p>We are done! Really, that is all there is to it.
We can now navigate to Cyberchef.henard.xyz and access our internal instance of Cyberchef!
The best part is that Cloudflare will take care of the SSL Cert for us!<figure><img class="mx-auto my-0 rounded-md" width=1917 height=1074 srcset="/p/tunneling-internal-services/AccessingTunnel_hu_68aa8b84b7eae1d5.png 330w,/p/tunneling-internal-services/AccessingTunnel_hu_cc6463d7798d4f86.png 660w,/p/tunneling-internal-services/AccessingTunnel_hu_ac202a1857332a15.png 1024w,/p/tunneling-internal-services/AccessingTunnel_hu_9234577ba350cbcf.png 2x" src=/p/tunneling-internal-services/AccessingTunnel_hu_cc6463d7798d4f86.png alt=cyberchef.henard.xyz loading=lazy></figure></p><h2 id=adding-additional-services class="relative group">Adding Additional Services <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#adding-additional-services aria-label=Anchor>#</a></span></h2><p>Now that we have a tunnel, it is super easy to add additional services.
Just go back to your Cloudflare tunnel configuration and add another &lsquo;Public Hostname&rsquo;.<figure><img class="mx-auto my-0 rounded-md" width=704 height=302 srcset="/p/tunneling-internal-services/AddingITtools_hu_a78d2c8490be93a.png 330w,/p/tunneling-internal-services/AddingITtools_hu_8ff27f3b6ffb2d77.png 660w,/p/tunneling-internal-services/AddingITtools_hu_bb053bbbb6eeb696.png 1024w,/p/tunneling-internal-services/AddingITtools_hu_d809d0ed3cd0e001.png 2x" src=/p/tunneling-internal-services/AddingITtools_hu_8ff27f3b6ffb2d77.png alt=AddingITtools loading=lazy></figure></p><p>Now if we go to ITtools.Henard.xyz we can access our self-hosted instance of ITtools!<figure><img class="mx-auto my-0 rounded-md" width=1904 height=1078 srcset="/p/tunneling-internal-services/AccessingITtools_hu_95c34d1f3541dd75.png 330w,/p/tunneling-internal-services/AccessingITtools_hu_3f6121f78e171c74.png 660w,/p/tunneling-internal-services/AccessingITtools_hu_61cb7c3678fc5240.png 1024w,/p/tunneling-internal-services/AccessingITtools_hu_1113e6ace4451527.png 2x" src=/p/tunneling-internal-services/AccessingITtools_hu_3f6121f78e171c74.png alt=AccessingITtools loading=lazy></figure></p><h2 id=bonus-adding-authentication-and-access-rules class="relative group">Bonus: Adding Authentication and Access Rules <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#bonus-adding-authentication-and-access-rules aria-label=Anchor>#</a></span></h2><p>Cloudflare makes it super easy to add an authentication portal in front of your tunnels.</p><p>In your Cloudflare dashboard, go to &lsquo;Zero Trust&rsquo; -> &lsquo;Settings&rsquo; -> &lsquo;Authentication&rsquo; -> &lsquo;Login Methods&rsquo;.
We can now see all of the authentication methods that Cloudflare supports.. which is a lot.</p><p>Just click your preferred authentication method and follow the steps to add it.
I will use One-Time Pin since it requires no initial configuration to implement.<figure><img class="mx-auto my-0 rounded-md" width=887 height=567 srcset="/p/tunneling-internal-services/AddingAuthMethod_hu_3645634c63bbedea.png 330w,/p/tunneling-internal-services/AddingAuthMethod_hu_46b332c24ebb6b6f.png 660w,/p/tunneling-internal-services/AddingAuthMethod_hu_2e08aa60f5519969.png 1024w,/p/tunneling-internal-services/AddingAuthMethod_hu_8484c27e40f4c826.png 2x" src=/p/tunneling-internal-services/AddingAuthMethod_hu_46b332c24ebb6b6f.png alt=AddingAuth loading=lazy></figure></p><p>After you have added our authentication method, go to &lsquo;Access&rsquo; -> &lsquo;Applications&rsquo;.
Click on &ldquo;Add an Application&rdquo; and our application type will be &ldquo;Self-Hosted&rdquo;.
Enter the application domain that we are using to host our services, which in my case is &ldquo;cyberchef.henard.xyz&rdquo;.<br>Towards the bottom of the page you will see a section called &ldquo;Identity Providers&rdquo;; This is where we will choose what authentication methods we want in front of our tunnel.
I only have one enabled, so that is what will be used.<figure><img class="mx-auto my-0 rounded-md" width=851 height=397 srcset="/p/tunneling-internal-services/AuthMethods_hu_63c93aba6978a920.png 330w,/p/tunneling-internal-services/AuthMethods_hu_ff48157774903776.png 660w,/p/tunneling-internal-services/AuthMethods_hu_efbd1a1a37ab556d.png 1024w,/p/tunneling-internal-services/AuthMethods_hu_42cb76b708297baa.png 2x" src=/p/tunneling-internal-services/AuthMethods_hu_ff48157774903776.png alt=AuthMethod loading=lazy></figure></p><p>After we click next, we are asked to add policies.
This is where we can implement many different kinds of rules as to who can or cannot access our service.
We can even block entire countries!<figure><img class="mx-auto my-0 rounded-md" width=1083 height=663 srcset="/p/tunneling-internal-services/ConfiguringRules_hu_bf5c3f30e0bfbcc2.png 330w,/p/tunneling-internal-services/ConfiguringRules_hu_12b428d8c14392dc.png 660w,/p/tunneling-internal-services/ConfiguringRules_hu_1e6971fde93093b8.png 1024w,/p/tunneling-internal-services/ConfiguringRules_hu_4962488a288c0fd1.png 2x" src=/p/tunneling-internal-services/ConfiguringRules_hu_12b428d8c14392dc.png alt=CreatingPolicies loading=lazy></figure></p><p>Once we have all the policies are created we just click &rsquo;next&rsquo; -> &lsquo;Add Application&rsquo;.
Now if we try to access cyberchef.henard.xyz, we are redirected to an authentication page that will prompt us for a one-time pin.<figure><img class="mx-auto my-0 rounded-md" width=575 height=355 src=/p/tunneling-internal-services/AccessToken.png alt=OTPVerification loading=lazy></figure></p></div></section><footer class="pt-8 max-w-prose print:hidden"><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?body=https://henard.xyz/p/tunneling-internal-services/&amp;subject=Tunneling%20Internal%20Services%20through%20Cloudflare" title="Send via email" aria-label="Send via email" target=_blank rel="noopener noreferrer"><span class="relative inline-block align-text-bottom px-1 icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg>
</span></a><a class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://henard.xyz/p/tunneling-internal-services/&amp;title=Tunneling%20Internal%20Services%20through%20Cloudflare" title="Share on LinkedIn" aria-label="Share on LinkedIn" target=_blank rel="noopener noreferrer"><span class="relative inline-block align-text-bottom px-1 icon"><svg viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></a></section><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="group flex" href=/p/securing-windows-11-to-dod-standards/><span class="me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"><span class="ltr:inline rtl:hidden">&larr;</span><span class="ltr:hidden rtl:inline">&rarr;</span></span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Securing Windows 11 to DoD Standards</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2023-11-19 00:00:00 +0000 UTC">19 November 2023</time>
</span></span></a></span><span></span></div></div></footer></article><div class="pointer-events-none absolute bottom-0 end-0 top-[100vh] w-12"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer class="py-10 print:hidden"><div class="flex items-center justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">All content licensed <a href=https://creativecommons.org/licenses/by-sa/4.0/ target=_blank rel=noreferrer>CC-BY-SA</a> ðŸ’œ</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://github.com/jpanther/congo target=_blank rel="noopener noreferrer">Congo</a></p></div><div class="flex flex-row items-center"><div class="me-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"><button id=appearance-switcher-0 type=button aria-label="appearance switcher"><div class="flex items-center justify-center w-12 h-12 dark:hidden" title="Switch to dark appearance"><span class="relative inline-block align-text-bottom px-1 icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden w-12 h-12 dark:flex" title="Switch to light appearance"><span class="relative inline-block align-text-bottom px-1 icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div></div></footer><div id=search-wrapper class="invisible fixed inset-0 z-50 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://henard.xyz/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative inline-block align-text-bottom px-1 icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative inline-block align-text-bottom px-1 icon"><svg viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>